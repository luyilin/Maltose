{"version":3,"sources":["maltose.js"],"names":["_classCallCheck","instance","Constructor","TypeError","_createClass","defineProperties","target","props","i","length","descriptor","enumerable","configurable","writable","Object","defineProperty","key","protoProps","staticProps","prototype","maltose","_this","this","option","arguments","undefined","defaultConfig","wrap","document","getElementsByClassName","getElementsByTagName","width","maxHeight","api","hasOwnProperty","xhr","XMLHttpRequest","onreadystatechange","readyState","status","data","JSON","parse","responseText","init","console","log","open","send","value","_this2","querySelector","content","keys","html","type","parseInt","li","container","j","notImg","classList","icon","text","innerHTML","addEventListener","e","contains","parentNode","focus","toggle","localName","blur","remove","main","event","stopPropagation","contentShow","children","getAttribute","cursorEnd","selectionEnd","targetValue","slice","title","_loop","changeTab","random","add","tab","ulContent","Math","floor","module","exports","window"],"mappings":"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","file":"maltose.min.js","sourcesContent":["(() => {\n  class maltose {\n    constructor(option = {}) {\n      const defaultConfig = {\n        wrap: document.getElementsByClassName('maltose')[0],\n        target: document.getElementsByTagName('textarea')[0],\n        width: '100%',\n        maxHeight: '200px',\n        api: 'https://luyilin.github.io/Maltose/demo/maltose.json'\n        // api: '../demo/maltose.json'\n      }\n      for(let i in defaultConfig) {\n        if (defaultConfig.hasOwnProperty(i) && !option.hasOwnProperty(i)) {\n          option[i] = defaultConfig[i]\n        }\n      }\n      this.wrap = option.wrap\n      this.target = option.target\n\n      const xhr = new XMLHttpRequest()\n      xhr.onreadystatechange = () => {\n        if (xhr.readyState === 4) {\n          if (xhr.status >= 200 && xhr.status < 300 || xhr.status === 304) {\n            this.data = JSON.parse(xhr.responseText)\n            this.init(option)\n          } else {\n            console.log('Request for emoticon resource was unsuccessful (｡•́︿•̀｡), the status code is ' + xhr.status)\n          }\n        }\n      }\n      xhr.open('get', option.api)\n      xhr.send(null)\n\n    }\n    init(option) {\n      if (!document.querySelector('.maltose')) return\n      this.content = Object.keys(this.data)\n      let html = `<div class='maltose-logo'><span>(ฅ>ω<*ฅ)</span></div>\n                        <div class='maltose-main' style='width: ${option.width}'>`\n      for(let i = 0; i < this.content.length; i++) {\n        html += `<ul class='maltose-ul maltose-ul-${this.data[this.content[i]].type}' style='max-height: ${parseInt(option.maxHeight) - 40 +'px'}'>`\n        let li = this.data[this.content[i]].container\n        for(let j = 0; j < li.length; j++) {\n          let notImg = this.content[i] === '颜文字' || this.content[i] === 'emoji'\n          let classList = 'maltose-li ' + (notImg ? '' : 'maltose-img')\n          let icon = notImg ? li[j].icon : '<img src=\\'' + li[j].icon + '\\'>'\n          html += '<li class=\\'' + classList + `' title='${li[j].text}'>${icon}</li>`\n        }\n        html += '</ul>'\n      }\n\n      html += '<ul class=\\'maltose-title\\'>'\n      for(let i = 0; i < this.content.length; i++) {\n        html += `<li class='maltose-tab'>${this.content[i]}</li>`\n      }\n      html += '<li class=\\'maltose-tab random-tab\\'>random!</li>'\n      html += '</ul></div>'\n\n      this.wrap.innerHTML = html\n\n      document.addEventListener('click', (e) => {\n        if (e.target.classList.contains('maltose-logo') || e.target.parentNode && e.target.parentNode.classList && e.target.parentNode.classList.contains('maltose-logo')) {\n          this.target.focus()\n          this.toggle()\n        }\n        else if (e.target.localName !== 'textarea') {\n          this.target.blur()\n          if (this.wrap.classList.contains('maltose-show')) {\n            this.wrap.classList.remove('maltose-show')\n          }\n        }\n      })\n\n      let main = document.getElementsByClassName('maltose-main')[0]\n      main.addEventListener('click', (j) => {\n        event.stopPropagation()\n        let content = null\n        if (j.target.classList.contains('maltose-li')) {\n          content = j.target\n        } else if (j.target.parentNode.classList.contains('maltose-li')) {\n          content = j.target.parentNode\n        }\n        if (content) {\n          let contentShow = content.classList.contains('maltose-img')\n            ? '![img](' + content.children[0].getAttribute('src') + ')'\n            : content.innerHTML\n          let cursorEnd = this.target.selectionEnd\n          let targetValue = this.target.value\n          this.target.focus()\n          this.target.value = targetValue.slice(0, cursorEnd) + contentShow + targetValue.slice(cursorEnd)\n          this.toggle()\n        }\n      })\n\n      let title = document.getElementsByClassName('maltose-title')[0]\n      for(let i = 0; i < title.children.length; i++) {\n        title.children[i].addEventListener('click', () => {\n          this.changeTab(i)\n        })\n      }\n      this.changeTab(0)\n\n      document.getElementsByClassName('random-tab')[0].addEventListener('click', () => {\n        this.random()\n      })\n    }\n    toggle() {\n      let main = document.getElementsByClassName('maltose-show')[0]\n      if (main) {\n        main.classList.remove('maltose-show')\n      } else {\n        this.wrap.classList.add('maltose-show')\n      }\n    }\n    changeTab(i) {\n      if (i > 4) return\n      let tab = document.getElementsByClassName('tab-show')[0]\n      if (tab) {\n        tab.classList.remove('tab-show')\n      }\n      document.getElementsByClassName('maltose-tab')[i].classList.add('tab-show')\n      let ulContent = document.getElementsByClassName('maltose-ul-show')[0]\n      if (ulContent) {\n        ulContent.classList.remove('maltose-ul-show')\n      }\n      document.getElementsByClassName('maltose-ul')[i].classList.add('maltose-ul-show')\n    }\n    random() {\n      let i = Math.floor(Math.random() * this.content.length)\n      let j = Math.floor(Math.random() * this.data[this.content[i]].container.length)\n      let notImg = this.content[i] === '颜文字' || this.content[i] === 'emoji'\n      let icon = this.data[this.content[i]].container[j].icon\n      let random = notImg ? icon : '![img](' + icon + ')'\n      let cursorEnd = this.target.selectionEnd\n      let targetValue = this.target.value\n      this.target.value = targetValue.slice(0, cursorEnd) + random + targetValue.slice(cursorEnd)\n      this.target.focus()\n      this.toggle()\n    }\n  }\n\n  if (typeof module != 'undefined' && typeof module.exports != 'undefined'){\n    module.exports = maltose\n  }\n  else {\n    window.maltose = maltose\n  }\n})()\n"]}